<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Modern Boy's Red Roof House</title>
    <style>
        /* 1. 전체 화면 설정 */
        body {
            margin: 0;
            padding: 0;
            height: 100vh;
            overflow: hidden;
            background-color: #f4f1ea;
            display: flex;
            justify-content: center;
            align-items: center;
            font-family: 'Apple SD Gothic Neo', sans-serif;
        }

        /* 2. 그림 액자 */
        .art-container {
            position: relative;
            width: 100%;
            height: 100%;
            max-width: 800px;
            overflow: hidden;
        }

        /* 3. 레이어 공통 스타일 */
        .layer {
            position: absolute;
            top: -5%;
            left: -5%;
            width: 110%;
            height: 110%;
            
            /* ⭐ 수정됨: 바닥을 기준으로 정렬 (긴 그림 깨짐 방지) ⭐ */
            background-size: cover; 
            background-position: center; 
            background-repeat: no-repeat;
            
            transition: transform 0.2s cubic-bezier(0.25, 0.46, 0.45, 0.94); /* 반응 속도 살짝 늦춰서 더 부드럽게 */
            will-change: transform;
        }

        /* 4. 이미지 경로 */
        .bg { background-image: url('bg.png'); z-index: 1; }
        .mid { background-image: url('mid.png'); z-index: 2; }
        .fore { background-image: url('fore.png'); z-index: 3; }

        /* 5. 버튼 스타일 */
        #permissionBtn {
            position: absolute;
            z-index: 100;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: #a63737;
            color: white;
            border: none;
            padding: 15px 40px;
            border-radius: 50px;
            font-size: 1.1rem;
            font-weight: bold;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            transition: opacity 0.3s;
        }
    </style>
</head>
<body>

    <div class="art-container" id="artContainer">
        <div class="layer bg" data-speed="1"></div>   <div class="layer mid" data-speed="2"></div>  <div class="layer fore" data-speed="4"></div> </div>

    <button id="permissionBtn">작품 입장하기 (Touch)</button>

    <script>
        const btn = document.getElementById('permissionBtn');
        const layers = document.querySelectorAll('.layer');
        const container = document.getElementById('artContainer');

        // 움직임 처리 함수
        function moveLayers(x, y) {
            layers.forEach(layer => {
                const speed = layer.getAttribute('data-speed');
                const xMove = -(x * speed); 
                const yMove = -(y * speed);
                layer.style.transform = `translate(${xMove}px, ${yMove}px)`;
            });
        }

        // 모바일 센서 처리
        function handleOrientation(event) {
            const x = event.gamma; 
            const y = event.beta;  
            
            if (x && y) {
                // 각도 제한
                const limitedX = Math.max(-40, Math.min(40, x));
                const limitedY = Math.max(-40, Math.min(40, y));
                
                // ⭐ 수정됨: 0.5 -> 0.15 (센서 민감도를 확 낮춤) ⭐
                // 이제 폰을 많이 기울여야 조금 움직입니다.
                moveLayers(limitedX * 0.30, limitedY * 0.30); 
            }
        }

        // PC 마우스 처리
        container.addEventListener('mousemove', (e) => {
            // ⭐ 수정됨: 나누는 수를 20 -> 50으로 늘려서 마우스 반응 둔하게 만듦
            const x = (window.innerWidth / 2 - e.pageX) / 50;
            const y = (window.innerHeight / 2 - e.pageY) / 50;
            moveLayers(x, y);
        });

        // 권한 요청
        function requestAccess() {
            btn.style.opacity = '0';
            setTimeout(() => { btn.style.display = 'none'; }, 300);

            if (typeof DeviceOrientationEvent !== 'undefined' && typeof DeviceOrientationEvent.requestPermission === 'function') {
                DeviceOrientationEvent.requestPermission()
                    .then(permissionState => {
                        if (permissionState === 'granted') {
                            window.addEventListener('deviceorientation', handleOrientation);
                        } else {
                            alert('센서 권한을 허용해야 그림이 움직입니다.');
                        }
                    })
                    .catch(console.error);
            } else {
                window.addEventListener('deviceorientation', handleOrientation);
            }
        }

        btn.addEventListener('click', requestAccess);
        
        if (typeof DeviceOrientationEvent !== 'undefined' && typeof DeviceOrientationEvent.requestPermission !== 'function') {
             window.addEventListener('deviceorientation', handleOrientation);
             btn.style.display = 'none';
        }
    </script>
</body>
</html>